# Hartree-Fock method

One of the simplest numerical corrections that could be applied to the initial guess is that of the Hartree–Fock (HF) method.  Using the variational principle, one can compute an approximate ground state $\Phi$ by minimizing the energy expectation value
\begin{align} \label{eq:hfexpectation}
  E_{\Phi} \equiv \langle \Phi | \hat H | \Phi \rangle,
\end{align}
with respect to $|\Phi\rangle$, subject to the restriction that $|\Phi\rangle$ remains a single Slater determinant constructed from an unknown single-particle basis.  The restriction is what enables the simplicity and efficiency of this method.  We shall denote each unknown single-particle state $|p'\rangle$ by a primed label $p'$.

To perform numerical calculations, we further assume that each unknown state $|p'\rangle$ is built from a linear combination of known states $|p\rangle$, with an unknown matrix of coefficients $\bm C$ defined via the transformation equation
\begin{align*}
  |p'\rangle \equiv \sum_p |p\rangle C_{p p'}.
\end{align*}
This allows the problem to be reduced from an abstract minimization problem \eqref{eq:hfexpectation} to a concrete numerical problem.  The caveat is that the set of known functions must be large enough to capture the relevant behavior of the system.

If the interaction is not too strong, it is common to use the single-particle states of the noninteracting Hamiltonian $\hat{H}_1$ as the set of known states.

To ensure orthonormality of the states, we require there to be as many unknown states $|p'\rangle$ as known states $|p\rangle$, and the coefficient matrix $\bm C$ must be unitary.  These conditions are more strict than necessary, but they greatly simplify the calculations and allow the states $|p'\rangle$ to act as *optimized* inputs for methods beyond HF.  At the end of the calculation, of the set of states $|p'\rangle$ there would exactly $N$ *occupied* states that participate in the optimized Slater determinant $|\Phi\rangle$.  The remaining *unoccupied* states serve as the complementary space into which particles can be excited by the interaction $\hat{H}_2$ during the post-HF calculation.

The goal then is to find the coefficients $\bm C$ that minimize the **Hartree–Fock energy** $E_{\Phi}$,
\begin{align}
  E_{\Phi} &= \sum_{i'} \langle i' | \hat{H}_1 | i' \rangle + \sum_{i' j'} \langle i' j' | \hat{H}_2 | i' j' \rangle \label{eq:hfenergy},
\end{align}
where
\begin{align}
  \langle p' | \hat{H}_1 | q' \rangle &= \sum_{p q} C_{p p'}^* \langle p | \hat{H}_1 | q \rangle C_{q q'}^{}, \label{eq:hftransform1} \\
  \langle p' q' | \hat{H}_2 | r' s' \rangle &= \sum_{p q r s} C_{p p'}^* C_{q q'}^* \langle p q | \hat{H}_2 | r s \rangle C_{r r'}^{} C_{s s'}^{}, \label{eq:hftransform2}
\end{align}

With the method of Lagrange multipliers, the minimization problem can be reduced to the solving of a nonlinear equation – the self-consistent **Hartree–Fock equations**:
\begin{align} \label{eq:hartreefock}
  \bm{F} \bm{C} = \bm{C} \bm{\varepsilon},
\end{align}
where the **Fock matrix** $\bm F$ is defined as
\begin{align} \label{eq:fock}
  F_{p q} \equiv \langle p | \hat{H}_1 | q \rangle + \sum_{r s i'} C_{r i'}^* \langle p r | \hat{H}_2 | q s \rangle C_{s i'}^{},
\end{align}
and $\bm{\varepsilon}$ is a vector of Lagrange multipliers, which serve to constrain the orthonormality of the single-particle basis.  Each multiplier $\varepsilon_{p'}$ is associated with a specific single-particle state $|p'\rangle$.

Aside from trivial cases that are analytically solvable, the HF equation is generally solved numerically using an iterative algorithm.  We begin with an initial guess $\bm{C}^{(j)}$ on the $j$-th iteration, which is fed into Eq. \eqref{eq:fock} to produce the Fock matrix.  This is then used in Eq. \eqref{eq:hartreefock}, which leads to a standard eigenvalue problem from which $\bm{C}^{(j + 1)}$ arise as the matrix of eigenvectors and $\bm{\varepsilon}^{(j + 1)}$ as the vector of eigenvalues.  This process can be repeated indefinitely until $\bm{C}$ approaches a fixed point (self-consistency).  While in theory it is possible for the solution to never reach a fixed point, or that it may require a unfeasibly large number of iterations, in practice this naive approach can adequately provide solutions for many cases.  In other cases where it is insufficient, methods such as DIIS [@PULAY1980393; @JCC:JCC540030413], Broyden’s method [@broyden1965class], or even *ad hoc* linear mixing can improve and accelerate convergence greatly.  Therefore, the possibility of slow or non-convergence is generally not a concern in practice.

For the initial guess, we simply use the ground state of our noninteracting Hamiltonian, thus $\bm{C}^{(0)} = \bm{1}$, the identity matrix.  At each iteration, we calculate the sum of the Lagrange multipliers $\bm{\varepsilon}$ as a diagnostic for convergence: as the iteration approaches convergence, the change in the sum per iteration should decrease rapidly.

Since HF restricts the ground state to merely a single Slater determinant of single-particle states, it cannot provide an exact solution to a problem where multi-particle correlations are present even if the single-particle basis is not truncated (infinite in size).  The discrepancy between the HF energy and the exact ground state energy is often referred to as the **correlation energy**, by definition.  The focus of post-HF methods such as IM-SRG or CC is to add corrections beyond mean-field approximations such as HF.

To make use of the HF solution as the reference state for post-HF calculations, we transform the matrix elements via Eqs. \eqref{eq:hftransform1} and \eqref{eq:hftransform2}.  In effect, this means we are no longer operating within the harmonic oscillator single-particle basis, but rather a HF-optimized single-particle basis.  However, we will omit the prime symbols as the post-HF methods are generic and can be used in any basis, whether optimized by HF or not.
